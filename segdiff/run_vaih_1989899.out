## SLURM PROLOG ###############################################################
##    Job ID : 1989899
##  Job Name : run_vaih
##  Nodelist : gpu2110
##      CPUs : 1
##  Mem/Node : 16384 MB
## Directory : /oscar/scratch/mxiangxi/CSCI1430-Final-Project-MedImage-Segmentation/segdiff
##   Job Started : Sat May 11 05:34:11 PM EDT 2024
###############################################################################
2024-05-11-17-34-20-232047  Logging to /oscar/scratch/mxiangxi/CSCI1430-Final-Project-MedImage-Segmentation/logs/2024-05-11-17-34-20-206813_vaih_256_6_0.0001_4_100_0.1_0
2024-05-11-17-34-20-232224  {'data_dir': '', 'schedule_sampler': 'uniform', 'lr': 0.0001, 'weight_decay': 0.0, 'lr_anneal_steps': 0, 'clip_denoised': False, 'batch_size': 4, 'microbatch': -1, 'ema_rate': '0.9999', 'save_interval': 5000, 'start_print_iter': 75000, 'log_interval': 200, 'run_without_test': False, 'resume_checkpoint': '', 'use_fp16': True, 'fp16_scale_growth': 0.001, 'image_size': 256, 'num_channels': 128, 'num_res_blocks': 3, 'num_heads': 4, 'num_heads_upsample': -1, 'attention_resolutions': '16,8', 'dropout': 0.1, 'rrdb_blocks': 6, 'deeper_net': True, 'learn_sigma': False, 'sigma_small': False, 'class_cond': False, 'class_name': 'train', 'expansion': False, 'diffusion_steps': 100, 'noise_schedule': 'linear', 'timestep_respacing': '', 'use_kl': False, 'predict_xstart': False, 'rescale_timesteps': False, 'rescale_learned_sigmas': False, 'use_checkpoint': False, 'use_scale_shift_norm': False, 'seed': None}
2024-05-11-17-34-20-237387  log folder path: /oscar/scratch/mxiangxi/CSCI1430-Final-Project-MedImage-Segmentation/logs/2024-05-11-17-34-20-206813_vaih_256_6_0.0001_4_100_0.1_0
2024-05-11-17-34-20-269228  git commit hash f32096a5e2e1bda9570225ccbea282d0d1233079
2024-05-11-17-34-20-269322  creating model and diffusion...
2024-05-11-17-34-21-509406  creating data loader...
2024-05-11-17-34-21-517945  gpu 0 / 1 val length 4014
2024-05-11-17-34-21-518045  training...
2024-05-11-17-34-21-520130  model folder path
2024-05-11-17-34-23-858497  torch.Size([4, 256, 256])
2024-05-11-17-34-27-977106  torch.Size([4, 256, 256])
2024-05-11-17-34-28-554288  Found NaN, decreased lg_loss_scale to 19.001
2024-05-11-17-34-29-152530  torch.Size([4, 256, 256])
2024-05-11-17-34-29-720283  Found NaN, decreased lg_loss_scale to 18.001
2024-05-11-17-34-30-317497  torch.Size([4, 256, 256])
2024-05-11-17-34-30-884990  Found NaN, decreased lg_loss_scale to 17.001
2024-05-11-17-34-31-480554  torch.Size([4, 256, 256])
2024-05-11-17-34-32-049936  Found NaN, decreased lg_loss_scale to 16.001
2024-05-11-17-34-32-672687  torch.Size([4, 256, 256])
2024-05-11-17-34-33-240921  Found NaN, decreased lg_loss_scale to 15.001000000000001
2024-05-11-17-34-33-843529  torch.Size([4, 256, 256])
2024-05-11-17-34-34-410710  Found NaN, decreased lg_loss_scale to 14.001000000000001
2024-05-11-17-34-35-006966  torch.Size([4, 256, 256])
2024-05-11-17-34-35-575336  Found NaN, decreased lg_loss_scale to 13.001000000000001
2024-05-11-17-34-36-174319  torch.Size([4, 256, 256])
2024-05-11-17-34-36-742457  Found NaN, decreased lg_loss_scale to 12.001000000000001
2024-05-11-17-34-37-333112  torch.Size([4, 256, 256])
2024-05-11-17-34-37-913590  Found NaN, decreased lg_loss_scale to 11.001000000000001
2024-05-11-17-34-38-523820  torch.Size([4, 256, 256])
2024-05-11-17-34-39-766624  torch.Size([4, 256, 256])
2024-05-11-17-34-41-011631  torch.Size([4, 256, 256])
2024-05-11-17-34-41-593651  Found NaN, decreased lg_loss_scale to 10.003
2024-05-11-17-34-42-193826  torch.Size([4, 256, 256])
2024-05-11-17-34-43-469998  torch.Size([4, 256, 256])
2024-05-11-17-34-44-712498  torch.Size([4, 256, 256])
2024-05-11-17-34-45-339768  Found NaN, decreased lg_loss_scale to 9.004999999999999
2024-05-11-17-34-45-931460  torch.Size([4, 256, 256])
2024-05-11-17-34-47-177638  torch.Size([4, 256, 256])
2024-05-11-17-34-47-807304  Found NaN, decreased lg_loss_scale to 8.005999999999998
2024-05-11-17-34-48-411510  torch.Size([4, 256, 256])
2024-05-11-17-34-49-651544  torch.Size([4, 256, 256])
2024-05-11-17-34-50-893749  torch.Size([4, 256, 256])
2024-05-11-17-34-52-139222  torch.Size([4, 256, 256])
2024-05-11-17-34-52-722979  Found NaN, decreased lg_loss_scale to 7.008999999999997
2024-05-11-17-34-53-308722  torch.Size([4, 256, 256])
2024-05-11-17-34-54-573779  torch.Size([4, 256, 256])
2024-05-11-17-34-55-824820  torch.Size([4, 256, 256])
2024-05-11-17-34-57-078805  torch.Size([4, 256, 256])
2024-05-11-17-34-57-663616  Found NaN, decreased lg_loss_scale to 6.011999999999998
2024-05-11-17-34-58-254436  torch.Size([4, 256, 256])
2024-05-11-17-34-59-511501  torch.Size([4, 256, 256])
2024-05-11-17-35-00-753158  torch.Size([4, 256, 256])
2024-05-11-17-35-01-337929  Found NaN, decreased lg_loss_scale to 5.0139999999999985
2024-05-11-17-35-01-928005  torch.Size([4, 256, 256])
2024-05-11-17-35-03-170662  torch.Size([4, 256, 256])
2024-05-11-17-35-04-454429  torch.Size([4, 256, 256])
2024-05-11-17-35-05-698232  torch.Size([4, 256, 256])
2024-05-11-17-35-06-943678  torch.Size([4, 256, 256])
2024-05-11-17-35-08-186453  torch.Size([4, 256, 256])
2024-05-11-17-35-09-447073  torch.Size([4, 256, 256])
2024-05-11-17-35-10-708593  torch.Size([4, 256, 256])
2024-05-11-17-35-11-293849  Found NaN, decreased lg_loss_scale to 4.021000000000001
2024-05-11-17-35-11-880887  torch.Size([4, 256, 256])
2024-05-11-17-35-13-130808  torch.Size([4, 256, 256])
2024-05-11-17-35-14-402625  torch.Size([4, 256, 256])
2024-05-11-17-35-14-987206  Found NaN, decreased lg_loss_scale to 3.0230000000000015
2024-05-11-17-35-15-600576  torch.Size([4, 256, 256])
2024-05-11-17-35-16-842258  torch.Size([4, 256, 256])
2024-05-11-17-35-18-082855  torch.Size([4, 256, 256])
2024-05-11-17-35-19-341715  torch.Size([4, 256, 256])
2024-05-11-17-35-20-590227  torch.Size([4, 256, 256])
2024-05-11-17-35-21-846212  torch.Size([4, 256, 256])
2024-05-11-17-35-23-097972  torch.Size([4, 256, 256])
2024-05-11-17-35-23-682932  Found NaN, decreased lg_loss_scale to 2.029000000000001
2024-05-11-17-35-26-312421  torch.Size([4, 256, 256])
2024-05-11-17-35-29-404423  torch.Size([4, 256, 256])
2024-05-11-17-35-31-997541  torch.Size([4, 256, 256])
2024-05-11-17-35-33-770942  torch.Size([4, 256, 256])
2024-05-11-17-35-36-479351  torch.Size([4, 256, 256])
2024-05-11-17-35-39-563583  torch.Size([4, 256, 256])
2024-05-11-17-35-40-831965  torch.Size([4, 256, 256])
2024-05-11-17-35-42-691814  torch.Size([4, 256, 256])
2024-05-11-17-35-45-132372  torch.Size([4, 256, 256])
2024-05-11-17-35-46-859705  torch.Size([4, 256, 256])
2024-05-11-17-35-49-154117  torch.Size([4, 256, 256])
2024-05-11-17-35-51-198019  torch.Size([4, 256, 256])
2024-05-11-17-35-53-135265  torch.Size([4, 256, 256])
2024-05-11-17-35-54-378133  torch.Size([4, 256, 256])
2024-05-11-17-35-57-648756  torch.Size([4, 256, 256])
2024-05-11-17-36-00-066526  torch.Size([4, 256, 256])
2024-05-11-17-36-01-326808  torch.Size([4, 256, 256])
2024-05-11-17-36-04-390256  torch.Size([4, 256, 256])
2024-05-11-17-36-07-242051  torch.Size([4, 256, 256])
2024-05-11-17-36-10-299202  torch.Size([4, 256, 256])
2024-05-11-17-36-12-317083  torch.Size([4, 256, 256])
2024-05-11-17-36-15-282984  torch.Size([4, 256, 256])
2024-05-11-17-36-17-892082  torch.Size([4, 256, 256])
2024-05-11-17-36-19-763466  torch.Size([4, 256, 256])
2024-05-11-17-36-21-531443  torch.Size([4, 256, 256])
2024-05-11-17-36-24-214336  torch.Size([4, 256, 256])
2024-05-11-17-36-25-472813  torch.Size([4, 256, 256])
2024-05-11-17-36-27-609220  torch.Size([4, 256, 256])
2024-05-11-17-36-28-194042  Found NaN, decreased lg_loss_scale to 1.0559999999999978
2024-05-11-17-36-29-891688  torch.Size([4, 256, 256])
2024-05-11-17-36-32-653996  torch.Size([4, 256, 256])
2024-05-11-17-36-34-369604  torch.Size([4, 256, 256])
2024-05-11-17-36-36-187460  torch.Size([4, 256, 256])
2024-05-11-17-36-38-882813  torch.Size([4, 256, 256])
2024-05-11-17-36-40-127782  torch.Size([4, 256, 256])
2024-05-11-17-36-41-377155  torch.Size([4, 256, 256])
2024-05-11-17-36-42-630368  torch.Size([4, 256, 256])
2024-05-11-17-36-45-142178  torch.Size([4, 256, 256])
2024-05-11-17-36-47-002724  torch.Size([4, 256, 256])
2024-05-11-17-36-48-853231  torch.Size([4, 256, 256])
2024-05-11-17-36-51-040286  torch.Size([4, 256, 256])
2024-05-11-17-36-52-282274  torch.Size([4, 256, 256])
2024-05-11-17-36-53-537158  torch.Size([4, 256, 256])
2024-05-11-17-36-54-779498  torch.Size([4, 256, 256])
2024-05-11-17-36-57-341821  torch.Size([4, 256, 256])
2024-05-11-17-36-59-234748  torch.Size([4, 256, 256])
2024-05-11-17-37-00-990562  torch.Size([4, 256, 256])
2024-05-11-17-37-04-280351  torch.Size([4, 256, 256])
2024-05-11-17-37-06-543184  torch.Size([4, 256, 256])
2024-05-11-17-37-09-311355  torch.Size([4, 256, 256])
2024-05-11-17-37-10-568033  torch.Size([4, 256, 256])
2024-05-11-17-37-12-451327  torch.Size([4, 256, 256])
2024-05-11-17-37-13-711631  torch.Size([4, 256, 256])
2024-05-11-17-37-15-726999  torch.Size([4, 256, 256])
2024-05-11-17-37-16-968356  torch.Size([4, 256, 256])
2024-05-11-17-37-19-828327  torch.Size([4, 256, 256])
2024-05-11-17-37-21-605266  torch.Size([4, 256, 256])
2024-05-11-17-37-24-240319  torch.Size([4, 256, 256])
2024-05-11-17-37-25-504328  torch.Size([4, 256, 256])
2024-05-11-17-37-26-741833  torch.Size([4, 256, 256])
2024-05-11-17-37-27-982792  torch.Size([4, 256, 256])
2024-05-11-17-37-29-851326  torch.Size([4, 256, 256])
2024-05-11-17-37-31-598345  torch.Size([4, 256, 256])
2024-05-11-17-37-34-126860  torch.Size([4, 256, 256])
2024-05-11-17-37-36-148007  torch.Size([4, 256, 256])
2024-05-11-17-37-37-391266  torch.Size([4, 256, 256])
2024-05-11-17-37-39-259454  torch.Size([4, 256, 256])
2024-05-11-17-37-41-219633  torch.Size([4, 256, 256])
2024-05-11-17-37-42-462444  torch.Size([4, 256, 256])
2024-05-11-17-37-43-694766  torch.Size([4, 256, 256])
2024-05-11-17-37-44-943484  torch.Size([4, 256, 256])
2024-05-11-17-37-46-197419  torch.Size([4, 256, 256])
2024-05-11-17-37-47-940503  torch.Size([4, 256, 256])
2024-05-11-17-37-49-187466  torch.Size([4, 256, 256])
2024-05-11-17-37-50-421212  torch.Size([4, 256, 256])
2024-05-11-17-37-51-687697  torch.Size([4, 256, 256])
2024-05-11-17-37-54-129786  torch.Size([4, 256, 256])
2024-05-11-17-37-55-370416  torch.Size([4, 256, 256])
2024-05-11-17-37-56-629469  torch.Size([4, 256, 256])
2024-05-11-17-37-58-440707  torch.Size([4, 256, 256])
2024-05-11-17-38-00-551191  torch.Size([4, 256, 256])
2024-05-11-17-38-02-471953  torch.Size([4, 256, 256])
2024-05-11-17-38-04-222664  torch.Size([4, 256, 256])
2024-05-11-17-38-06-123598  torch.Size([4, 256, 256])
2024-05-11-17-38-07-394224  torch.Size([4, 256, 256])
2024-05-11-17-38-09-173356  torch.Size([4, 256, 256])
2024-05-11-17-38-11-714370  torch.Size([4, 256, 256])
2024-05-11-17-38-12-959788  torch.Size([4, 256, 256])
2024-05-11-17-38-14-204029  torch.Size([4, 256, 256])
2024-05-11-17-38-15-480458  torch.Size([4, 256, 256])
2024-05-11-17-38-16-725094  torch.Size([4, 256, 256])
2024-05-11-17-38-19-203780  torch.Size([4, 256, 256])
2024-05-11-17-38-20-451429  torch.Size([4, 256, 256])
2024-05-11-17-38-22-258495  torch.Size([4, 256, 256])
2024-05-11-17-38-23-502043  torch.Size([4, 256, 256])
2024-05-11-17-38-24-749230  torch.Size([4, 256, 256])
2024-05-11-17-38-25-993383  torch.Size([4, 256, 256])
2024-05-11-17-38-27-245480  torch.Size([4, 256, 256])
2024-05-11-17-38-29-037141  torch.Size([4, 256, 256])
2024-05-11-17-38-30-282595  torch.Size([4, 256, 256])
2024-05-11-17-38-32-272285  torch.Size([4, 256, 256])
2024-05-11-17-38-33-542763  torch.Size([4, 256, 256])
2024-05-11-17-38-35-385797  torch.Size([4, 256, 256])
2024-05-11-17-38-37-445699  torch.Size([4, 256, 256])
2024-05-11-17-38-39-952237  torch.Size([4, 256, 256])
2024-05-11-17-38-41-233746  torch.Size([4, 256, 256])
2024-05-11-17-38-43-270270  torch.Size([4, 256, 256])
2024-05-11-17-38-44-514333  torch.Size([4, 256, 256])
2024-05-11-17-38-45-762187  torch.Size([4, 256, 256])
2024-05-11-17-38-47-559895  torch.Size([4, 256, 256])
2024-05-11-17-38-50-023782  torch.Size([4, 256, 256])
2024-05-11-17-38-51-933507  torch.Size([4, 256, 256])
2024-05-11-17-38-53-192646  torch.Size([4, 256, 256])
2024-05-11-17-38-54-471638  torch.Size([4, 256, 256])
2024-05-11-17-38-55-709142  torch.Size([4, 256, 256])
2024-05-11-17-38-56-950915  torch.Size([4, 256, 256])
2024-05-11-17-38-58-899134  torch.Size([4, 256, 256])
2024-05-11-17-39-00-138394  torch.Size([4, 256, 256])
2024-05-11-17-39-01-387654  torch.Size([4, 256, 256])
2024-05-11-17-39-02-630500  torch.Size([4, 256, 256])
2024-05-11-17-39-03-898021  torch.Size([4, 256, 256])
2024-05-11-17-39-05-149938  torch.Size([4, 256, 256])
2024-05-11-17-39-06-936818  torch.Size([4, 256, 256])
2024-05-11-17-39-08-180532  torch.Size([4, 256, 256])
2024-05-11-17-39-10-141967  torch.Size([4, 256, 256])
2024-05-11-17-39-11-378781  torch.Size([4, 256, 256])
2024-05-11-17-39-12-632186  torch.Size([4, 256, 256])
2024-05-11-17-39-13-877054  torch.Size([4, 256, 256])
2024-05-11-17-39-15-131871  torch.Size([4, 256, 256])
2024-05-11-17-39-16-387902  torch.Size([4, 256, 256])
2024-05-11-17-39-17-639175  torch.Size([4, 256, 256])
2024-05-11-17-39-18-881265  torch.Size([4, 256, 256])
2024-05-11-17-39-20-124084  torch.Size([4, 256, 256])
2024-05-11-17-39-21-373657  torch.Size([4, 256, 256])
2024-05-11-17-39-22-628425  torch.Size([4, 256, 256])
2024-05-11-17-39-23-873388  torch.Size([4, 256, 256])
2024-05-11-17-39-25-124587  torch.Size([4, 256, 256])
