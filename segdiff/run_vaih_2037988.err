15:4: not a valid test operator:  
15:4: not a valid test operator: 12.4
21:4: not a valid test operator: (
21:4: not a valid test operator: 535.129.03
Generating image samples for FID evaluation.:   0%|          | 0/378 [00:00<?, ?it/s]
  0%|          | 0/100 [00:00<?, ?it/s][A  0%|          | 0/100 [00:02<?, ?it/s]
Generating image samples for FID evaluation.:   0%|          | 0/378 [00:03<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/val_isic.py", line 88, in <module>
[rank0]:     main()
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/val_isic.py", line 66, in main
[rank0]:     sampling_major_vote_func(diffusion, model, str(logs_path / "major_vote"), test_dataset, logger, args.clip_denoised,
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/sampling_util.py", line 148, in sampling_major_vote_func
[rank0]:     x = diffusion_model.p_sample_loop(
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/gaussian_diffusion.py", line 418, in p_sample_loop
[rank0]:     for sample in self.p_sample_loop_progressive(
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/gaussian_diffusion.py", line 468, in p_sample_loop_progressive
[rank0]:     out = self.p_sample(
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/gaussian_diffusion.py", line 374, in p_sample
[rank0]:     out = self.p_mean_variance(
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/respace.py", line 91, in p_mean_variance
[rank0]:     return super().p_mean_variance(self._wrap_model(model), *args, **kwargs)
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/gaussian_diffusion.py", line 260, in p_mean_variance
[rank0]:     model_output = model(x, self._scale_timesteps(t), **model_kwargs)
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/respace.py", line 122, in __call__
[rank0]:     return self.model(x, new_ts, **kwargs)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1520, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/unet.py", line 485, in forward
[rank0]:     former_frames_features = self.rrdb(conditioned_image.type(self.inner_dtype))
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1520, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/RRDB.py", line 67, in forward
[rank0]:     trunk = self.trunk_conv(self.RRDB_trunk(fea))
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1520, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/container.py", line 217, in forward
[rank0]:     input = module(input)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1520, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/RRDB.py", line 49, in forward
[rank0]:     out = self.RDB3(out)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1520, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/users/xwang259/CSCI1430-Final-Project-MedImage-Segmentation/CSCI1430-Final-Project-MedImage-Segmentation/segdiff/improved_diffusion/RRDB.py", line 33, in forward
[rank0]:     x5 = self.conv5(torch.cat((x, x1, x2, x3, x4), 1))
[rank0]: torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.05 GiB. GPU 0 has a total capacity of 23.68 GiB of which 4.94 GiB is free. Including non-PyTorch memory, this process has 18.70 GiB memory in use. Of the allocated memory 9.14 GiB is allocated by PyTorch, and 9.27 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
srun: error: gpu2502: task 0: Exited with exit code 1
